<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/img/logo.png"><link rel="manifest" href="/manifest.json"><script async>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?36884888f7a05e80a42de77a45873e51";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s)})();</script><title>blog vuepress 升级备忘录 | stormbuf's blog</title><meta name="description" content="stormbuf 的博客">
    <link rel="modulepreload" href="/assets/app.edc637f8.js"><link rel="modulepreload" href="/assets/blog_vuepress_upgrade_memo.html.6522ce75.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/blog_vuepress_upgrade_memo.html.624ef613.js">
    <link rel="stylesheet" href="/assets/style.924ef254.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">stormbuf&#39;s blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="home"><!--[--><!--]--> home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="program"><span class="title">program</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="program"><span class="title">program</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/program/java/" class="" aria-label="java"><!--[--><!--]--> java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/golang/" class="" aria-label="golang"><!--[--><!--]--> golang <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/distributed/" class="" aria-label="分布式"><!--[--><!--]--> 分布式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/frontEnd/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/db/" class="" aria-label="database"><!--[--><!--]--> database <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/weekly/" class="" aria-label="weekly"><!--[--><!--]--> weekly <!--[--><!--]--></a></div><div class="navbar-item"><a href="/archivesPage/" class="" aria-label="timeline"><!--[--><!--]--> timeline <!--[--><!--]--></a></div><div class="navbar-item"><a href="/friends/" class="" aria-label="friends"><!--[--><!--]--> friends <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://stormbuf.top/rss.xml" target="_self" aria-label="RSS"><!--[--><!--]--> RSS <!----><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="home"><!--[--><!--]--> home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="program"><span class="title">program</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="program"><span class="title">program</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/program/java/" class="" aria-label="java"><!--[--><!--]--> java <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/golang/" class="" aria-label="golang"><!--[--><!--]--> golang <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/distributed/" class="" aria-label="分布式"><!--[--><!--]--> 分布式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/program/frontEnd/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/db/" class="" aria-label="database"><!--[--><!--]--> database <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/weekly/" class="" aria-label="weekly"><!--[--><!--]--> weekly <!--[--><!--]--></a></div><div class="navbar-item"><a href="/archivesPage/" class="" aria-label="timeline"><!--[--><!--]--> timeline <!--[--><!--]--></a></div><div class="navbar-item"><a href="/friends/" class="" aria-label="friends"><!--[--><!--]--> friends <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://stormbuf.top/rss.xml" target="_self" aria-label="RSS"><!--[--><!--]--> RSS <!----><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading">blog vuepress 升级备忘录 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#动机" class="router-link-active router-link-exact-active sidebar-item" aria-label="动机"><!--[--><!--]--> 动机 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#背景" class="router-link-active router-link-exact-active sidebar-item" aria-label="背景"><!--[--><!--]--> 背景 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#前置知识点学习来源" class="router-link-active router-link-exact-active sidebar-item" aria-label="前置知识点学习来源"><!--[--><!--]--> 前置知识点学习来源 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#升级" class="router-link-active router-link-exact-active sidebar-item" aria-label="升级"><!--[--><!--]--> 升级 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#升级-vuepress-依赖" class="router-link-active router-link-exact-active sidebar-item" aria-label="升级 vuepress 依赖"><!--[--><!--]--> 升级 vuepress 依赖 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#js-替换成-ts" class="router-link-active router-link-exact-active sidebar-item" aria-label="js 替换成 ts"><!--[--><!--]--> js 替换成 ts <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#插件还原" class="router-link-active router-link-exact-active sidebar-item" aria-label="插件还原"><!--[--><!--]--> 插件还原 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#添加网站统计" class="router-link-active router-link-exact-active sidebar-item" aria-label="添加网站统计"><!--[--><!--]--> 添加网站统计 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#config-ts-添加类型支持" class="router-link-active router-link-exact-active sidebar-item" aria-label="config.ts 添加类型支持"><!--[--><!--]--> config.ts 添加类型支持 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#归档组件改造" class="router-link-active router-link-exact-active sidebar-item" aria-label="归档组件改造"><!--[--><!--]--> 归档组件改造 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/program/frontEnd/blog_vuepress_upgrade_memo.html#后续" class="router-link-active router-link-exact-active sidebar-item" aria-label="后续"><!--[--><!--]--> 后续 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="blog-vuepress-升级备忘录" tabindex="-1"><a class="header-anchor" href="#blog-vuepress-升级备忘录" aria-hidden="true">#</a> blog vuepress 升级备忘录</h1><h2 id="动机" tabindex="-1"><a class="header-anchor" href="#动机" aria-hidden="true">#</a> 动机</h2><p>编程语言只是工具。</p><p>学习一门编程语言捷径，需求驱动开发。</p><p>作为一名后端程序员，让非专业人员用上自己开发的成果，前端是必不可少的。</p><p>此时，学习前端就是自然而然的事情，同时也需要一个需求驱动。</p><h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景" aria-hidden="true">#</a> 背景</h2><p>前端的生态重复造轮子情况比较多，而且更新换代非常快，所以干脆从主流比较新的技术栈开始入手学习。</p><p>目前我的blog使用的是 vuepress 框架，底层使用的 vue2、js、webpack。</p><p>恰好该框架开发了 vuepress 2.x 版本，该版本采用了 vue3、ts、vite，所以我决定通过升级 blog 框架来入门前端。</p><h2 id="前置知识点学习来源" tabindex="-1"><a class="header-anchor" href="#前置知识点学习来源" aria-hidden="true">#</a> 前置知识点学习来源</h2><p>js:</p><ul><li><a href="https://wangdoc.com/javascript/index.html" target="_blank" rel="noopener noreferrer">https://wangdoc.com/javascript/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li><li><a href="https://wangdoc.com/es6/" target="_blank" rel="noopener noreferrer">https://wangdoc.com/es6/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul><p>ts:</p><ul><li><a href="https://www.typescriptlang.org/zh/docs/" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/zh/docs/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li><li><a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer">https://www.tslang.cn/docs/home.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li><li><a href="https://typescript.bootcss.com/" target="_blank" rel="noopener noreferrer">https://typescript.bootcss.com/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul><p>vue3:</p><ul><li><a href="https://v3.cn.vuejs.org/guide/introduction.html" target="_blank" rel="noopener noreferrer">https://v3.cn.vuejs.org/guide/introduction.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul><h2 id="升级" tabindex="-1"><a class="header-anchor" href="#升级" aria-hidden="true">#</a> 升级</h2><p>从 <code>main</code> 分支切出一个升级分支<code>feat/vuepress_upgrade</code>。升级完成再合并回去。</p><h3 id="升级-vuepress-依赖" tabindex="-1"><a class="header-anchor" href="#升级-vuepress-依赖" aria-hidden="true">#</a> 升级 vuepress 依赖</h3><p>由于 vuepress 1.x 与 vuepress 2.x 有许多不兼容的地方，一个一个踩坑替换过于麻烦 ，所以我记录下使用的插件。然后卸载 vuepress 1.x 依赖，再重新安装 vuepress 2.x 依赖。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#C9D1D9;">yarn add -D vuepress@next</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>vuepress 2.x 新增了一个默认的临时目录和缓存目录，所以需要添加到 <code>.gitignore</code> 文件中。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#79C0FF;">echo</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;.temp&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&gt;&gt;</span><span style="color:#C9D1D9;"> .gitignore</span></span>
<span class="line"><span style="color:#79C0FF;">echo</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;.cache&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&gt;&gt;</span><span style="color:#C9D1D9;"> .gitignore</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="js-替换成-ts" tabindex="-1"><a class="header-anchor" href="#js-替换成-ts" aria-hidden="true">#</a> js 替换成 ts</h3><ol><li>安装 ts : <code>yarn global add typescript</code></li><li>cd 到项目根目录</li><li>执行命令初始化为 ts 项目：<code>tsc --init</code>，生成的<code>tsconfig.json</code>可以按需修改</li><li>所有 js 文件后缀改为 ts</li><li>安装类型依赖。js 有大量的库是使用 js 写的，通过 ts 使用时会报类型缺失的错误。主流的库基本都提供了类型声明依赖，可以通过 <code>@types/xxx</code> 获取。比如：<code>@types/node</code>。如果你使用的 js 库没有提供类型声明，则需要你自己根据 import 使用的内容来提供一份类型声明文件 <code>.d.ts</code></li></ol><p>具体的迁移可以参考：</p><p><a href="https://jkchao.github.io/typescript-book-chinese/typings/migrating.html" target="_blank" rel="noopener noreferrer">https://jkchao.github.io/typescript-book-chinese/typings/migrating.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>下面是我使用的<code>tsconfig.json</code></p><div class="language-json ext-json line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">&quot;compilerOptions&quot;</span><span style="color:#C9D1D9;">: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// &quot;incremental&quot;: true,                   /* 增量编译 提高编译速度*/</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;target&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;ES2020&quot;</span><span style="color:#C9D1D9;">,                       </span><span style="color:#8B949E;">/* 编译目标ES版本*/</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;module&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;commonjs&quot;</span><span style="color:#C9D1D9;">,                     </span><span style="color:#8B949E;">/* 编译目标模块系统*/</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// &quot;lib&quot;: [],                             /* 编译过程中需要引入的库文件列表*/</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;outDir&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;dist&quot;</span><span style="color:#C9D1D9;">,                         </span><span style="color:#8B949E;">/* ts编译输出目录 */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;rootDir&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;docs&quot;</span><span style="color:#C9D1D9;">,                         </span><span style="color:#8B949E;">/* ts编译根目录. */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// &quot;importHelpers&quot;: true,                 /* 从tslib导入辅助工具函数(如__importDefault)*/</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;checkJs&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 报告 javascript 文件中的错误</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;strict&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/* Enable all strict type-checking options. */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noImplicitAny&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 在表达式和声明上有隐含的 any类型时报错</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;strictNullChecks&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 启用严格的 null 检查</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noImplicitThis&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 当 this 表达式值为 any 类型的时候，生成一个错误</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/* 额外的检查 */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noUnusedLocals&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 有未使用的变量时，抛出错误</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noUnusedParameters&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 有未使用的参数时，抛出错误</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noImplicitReturns&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 并不是所有函数里的代码都有返回值时，抛出错误</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;noFallthroughCasesInSwitch&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 报告 switch 语句的 fallthrough 错误。（即，不允许 switch 的 case 语句贯穿）</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;declaration&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 生成相应的 &#39;.d.ts&#39; 文件</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;sourceMap&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 生成相应的 &#39;.map&#39; 文件</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;moduleResolution&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;node&quot;</span><span style="color:#C9D1D9;">,               </span><span style="color:#8B949E;">/* 模块解析策略 */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;baseUrl&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#A5D6FF;">&quot;./&quot;</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 用于解析非相对模块名称的基目录</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;types&quot;</span><span style="color:#C9D1D9;">: [ </span><span style="color:#8B949E;">/* 要包含的类型声明文件路径列表*/</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&quot;./typings&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&quot;node_modules/@types&quot;</span></span>
<span class="line"><span style="color:#C9D1D9;">    ],                     </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">&quot;esModuleInterop&quot;</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">                  </span><span style="color:#8B949E;">/* 允许编译生成文件时，在代码中注入工具类(__importDefault、__importStar)对ESM与commonjs混用情况做兼容处理*/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">&quot;include&quot;</span><span style="color:#C9D1D9;">: [                                </span><span style="color:#8B949E;">/* 需要编译的文件 */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&quot;docs/**/*.ts&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&quot;typings/**/*.ts&quot;</span></span>
<span class="line"><span style="color:#C9D1D9;">  ],</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">&quot;exclude&quot;</span><span style="color:#C9D1D9;">: [                                </span><span style="color:#8B949E;">/* 编译需要排除的文件 */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">&quot;node_modules/**&quot;</span></span>
<span class="line"><span style="color:#C9D1D9;">  ],</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="插件还原" tabindex="-1"><a class="header-anchor" href="#插件还原" aria-hidden="true">#</a> 插件还原</h3><ol><li>@vuepress/back-to-top</li><li>@vuepress/nprogress</li><li>@vuepress/medium-zoom</li><li>@vuepress/plugin-search</li><li>@vuepress/plugin-shiki</li></ol><p>这些插件依然提供，按官方文档正常使用就行</p><p>原插件 feed 因为 vuepress 插件 api 的变动无法正常使用，作者也很久没有维护了。</p><p>作为替代，基于官方插件<code>@vuepress/plugin-git</code>提供的页面更新时间数据，我实现了一个生成 RSS 的插件 <code>@stormbuf/vuepress-plugin-rss</code>。</p><p>具体可以在 <a href="https://github.com/stormbuf/vuepress-plugin-rss" target="_blank" rel="noopener noreferrer">https://github.com/stormbuf/vuepress-plugin-rss<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 了解。</p><h3 id="添加网站统计" tabindex="-1"><a class="header-anchor" href="#添加网站统计" aria-hidden="true">#</a> 添加网站统计</h3><h4 id="谷歌统计" tabindex="-1"><a class="header-anchor" href="#谷歌统计" aria-hidden="true">#</a> 谷歌统计</h4><p>使用插件 <code>@vuepress/plugin-google-analytics</code>，</p><h4 id="百度统计" tabindex="-1"><a class="header-anchor" href="#百度统计" aria-hidden="true">#</a> 百度统计</h4><p>在 config.ts head 配置中添加百度统计提供的脚本。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#FFA657;">head</span><span style="color:#C9D1D9;">: [</span></span>
<span class="line"><span style="color:#C9D1D9;">    [</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&#39;link&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// 设置 favicon.ico，注意图片放在 public 文件夹下</span></span>
<span class="line"><span style="color:#C9D1D9;">      {</span></span>
<span class="line"><span style="color:#C9D1D9;">        rel: </span><span style="color:#A5D6FF;">&#39;icon&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        href: </span><span style="color:#A5D6FF;">&#39;/img/logo.png&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    ],</span></span>
<span class="line"><span style="color:#C9D1D9;">    [</span><span style="color:#A5D6FF;">&#39;link&#39;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">      rel: </span><span style="color:#A5D6FF;">&#39;manifest&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      href: </span><span style="color:#A5D6FF;">&#39;/manifest.json&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">    }],</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// 百度统计脚本</span></span>
<span class="line"><span style="color:#C9D1D9;">    [</span><span style="color:#A5D6FF;">&#39;script&#39;</span><span style="color:#C9D1D9;">, {async: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">},</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&quot;js 脚本&quot;</span></span>
<span class="line"><span style="color:#C9D1D9;">    ],</span></span>
<span class="line"><span style="color:#C9D1D9;">  ]</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="config-ts-添加类型支持" tabindex="-1"><a class="header-anchor" href="#config-ts-添加类型支持" aria-hidden="true">#</a> config.ts 添加类型支持</h3><p>import 相关依赖：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { defineUserConfig } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;vuepress&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">type</span><span style="color:#C9D1D9;"> { DefaultThemeOptions } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;vuepress&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>导出的 config 放入<code>defineUserConfig </code>函数中</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#D2A8FF;">defineUserConfig</span><span style="color:#FFA657;">&lt;DefaultThemeOptions&gt;({})</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="归档组件改造" tabindex="-1"><a class="header-anchor" href="#归档组件改造" aria-hidden="true">#</a> 归档组件改造</h3><p>原归档组件由于 vuepress 升级后，插件 api 和主题 api 的不兼容导致无法使用。</p><p>原归档组件可以通过组件实例 <code>this</code> 直接获取到所有页面的信息。但是在 vuepress 2.x 中就没这么方便了，最终我通过另一个方式迂回获取数据源。</p><p><strong>实现思路：</strong></p><ol><li>基于官方插件<code>@vuepress/plugin-git</code>提供的页面更新时间数据</li><li>继承默认主题，通过 开发 Hook <code>extendsPage</code>收集页面的信息和更新时间</li><li>在生命周期 Hook <code>onPrepared</code>中，使用Node API <code>writeTemp</code>将页面数据写入临时文件<code>storeData.ts</code></li><li>归档组件通过命令：<code>import {archivesPageData} from &#39;@temp/storeData&#39;</code>获取页面数据</li></ol><p>其余实现和原实现差不多，另外还删除了多余的代码。</p><p>归档组件写法也向 vue3 靠拢。添加了 ts 支持，添加了类型识别。不过暂时并未用 vue3 的组合式 api 写法重写组件。</p><h2 id="后续" tabindex="-1"><a class="header-anchor" href="#后续" aria-hidden="true">#</a> 后续</h2><p>评论功能由于 Vssue 不支持 vuepress 2.x 暂时恢复不了。</p><p>后续打算封装 Ant Design of Vue Comment 组件，并整合 vssue 里与 git 托管网站 issue 交互的功能实现自己的评论组件。</p><p>同时还打算继续添加 <strong>newsletter</strong>、<strong>sitemap</strong> 功能。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.edc637f8.js" defer></script>
  </body>
</html>
